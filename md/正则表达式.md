## 简介

正则表达式是一组由字母和符号组成的特殊文本，可以用来从文本中找出满足需要的格式的句子。正则表达式是 **大小写敏感** 的

## 界定符 `//`

表示一个正则表达式的开始和结束

## 元字符

正则表达式主要依赖于元字符。元字符不代表他们本身的字面意思，他们都有特殊的含义。一些元字符写在方括号中的时候有一些特殊的意思

- `.`：匹配任意单个字符，除了换行符
- `*`：匹配前一个表达式 0 次或多次，等价于 `{0,}`
- `+`：匹配前面一个表达式 1 次或者多次，等价于 `{1,}`
- `?`：匹配前面一个表达式 0 次或者 1 次，等价于 `{0,1}`
- `{n,m}`：n 和 m 都是整数。匹配前面的字符 **至少 n 次，最多 m 次**
  - `{n}`：匹配了前面的字符 **刚好** 出现了 n 次
  - `{n,}`：匹配了前面的字符 **至少** 出现了 n 次
- `[xyz]`：字符种类，匹配方括号内的任意字符
  - `[a-z]`：等价于 `[abcdefghijklmnopqrstuvwxyz]`
- `[^xyz]`：否定的字符种类，匹配除了方括号里的任意字符
  - `[^a-z]`：等价于 `[^abcdefghijklmnopqrstuvwxyz]`
- `(xyz)`：字符集，匹配与括号中相同的字符串
- `|`：或运算符，匹配符号前或后的字符
- `\`：转义字符，用于匹配一些保留的字符，例如 `\{}[]()|*.+?` 等
- `^`：匹配输入的开始
- `$`：匹配输入的结束
- `\w`：匹配一个单字字符（字母、数字或者下划线），等价于 `[A-Za-z0-9_]`
  - `\W`：匹配一个非单字字符，等价于 `[^A-Za-z0-9_]`
- `\d`：匹配一个数字，等价于 `[0-9]`
  - `\D`：匹配一个非数字字符，等价于 `[^0-9]`
- `\s`：匹配一个空白字符，包括空格、制表符、换页符和换行符
  - `\S`：匹配一个非空白字符
- `\b`：匹配一个词的边界
  - `\B`：匹配一个非单词边界
- `[\b]`：匹配一个退格符
- `\f`：匹配一个换页符
- `\n`：匹配一个换行符
- `\r`：匹配一个回车符
- `\t`：匹配一个制表符
- `\v`：匹配一个垂直制表符

## 标志

写在结束的 `/` 之后，可以影响整个正则表达式的匹配行为，可以组合使用

- `g`：全局搜索
- `i`：不区分大小写搜索
- `m`：多行搜索
- `s`：允许 `.` 匹配换行符
- `u`：使用 unicode 码的模式进行匹配
- `y`：执行粘性搜索，匹配从目标字符串的当前位置开始

## 捕获和非捕获

分组捕获的内容可以在表达式或其他程序中作进一步的处理，主要用于重复搜索前面某个分组匹配的文本

### 数字编号捕获组

从表达式左侧开始，每出现一个左括号和它对应的右括号之间的内容为一个分组，在分组中，**第 0 组为整个表达式**，第一组开始为分组：`(exp)`

- 例如 `020-8565333` 的正则表达式为 `(0\d{2})-(\d{8})`
  - 第 0 组：`(0\d{2})-(\d{8})`，匹配内容为：`020-85653333`
  - 第 1 组：`(0\d{2})`，匹配内容为：`020`
  - 第 2 组：`(\d{8})`，匹配内容为：`85653333`

### 命名编号捕获组

分组的命名由表达式中的名称指定：`(?<name>exp)`

- 例如 `020-8565333` 的正则表达式为 `(?<quhao>\0\d{2})-(?<haoma>\d{8})`
  - 第 0 组：`(?<quhao>\0\d{2})-(?<haoma>\d{8})`，匹配内容为：`020-85653333`
  - quhao 组：`(?<quhao>\0\d{2})`，匹配内容为：`020`
  - haoma 组：`(?<haoma>\d{8})`，匹配内容为：`85653333`

### 非捕获组

与捕获组刚好相反，用来标识那些不需要捕获的分组：`(?:exp)`

- 例如 `020-8565333` 的正则表达式为 `(?:0\d{2})-(\d{8})`
  - 第 0 组：`(0\d{2})-(\d{8})`，匹配内容为：`020-85653333`
  - 第 1 组：`(\d{8})`，匹配内容为：`85653333`

## 反向引用

捕获会返回一个捕获组，这个分组是保存在内存中，不仅可以在正则表达式外部通过程序进行引用，也可以在正则表达式内部进行引用，这种引用方式就是反向引用

### 根据捕获分组顺序命名

默认情况下，每个分组会自动拥有一个组号。分配组号的规则是：从左向右，以分组的左括号为标志，第一个出现的分组的组号为 1，第二个为 2，以此类推

```javascript
# \1表示分组1匹配的某个文本
# 匹配连着的两个重复的单词：ww ww
var pattern = /\b(w+)\b\s+\1\b/;
```

### 自定义命名来作为捕获组的命名

可以指定子表达式的组名

```javascript
# 可以指定组名为Word，要反向引用这个分组捕获的内容，可以使用\k<Word>
var pattern = /\b(?<Word>\w+)\b\s+\k<Word>\b/;
```

## 零宽断言（zero-length assertions）

零宽的意思是指该位置是不占宽度的，也就是只作断言判断，但不匹配实际的内容

- 正向与负向：断言括号中的内容是匹配还是不匹配
- 先行与回顾：实际匹配的内容在断言内容的前面还是后面

### 正向先行（Positive Lookahead）

匹配 **表达式的前面内容**，不返回本身：`(?=pattern)`

```javascript
var str = "wwww1wwwaa2waww3";
# 匹配ww之前的数字，匹配结果为1
var pattern = /\d+(?=ww)/;
```

### 正向回顾（Positive Lookbehind）

匹配 **表达式的后面的内容**，不返回本身：`(?<=pattern)`

```javascript
var str = "wwww1wwwaa2waww3";
# 匹配ww之后的数字，匹配结果为1、3
var pattern = /(?<=ww)\d+/;
```

### 负向先行（Negative Lookahead）

匹配 **非表达式的前面内容**，不返回本身：`(?!pattern)`

```javascript
var str = "wwww1wwwaa2waww3";
# 匹配非ww之前的数字，匹配结果为2、3
var pattern = /\d+(?!ww)/;
```

### 负向回顾（Negative Lookbehind）

匹配 **非表达式的后面内容**，不返回本身：`(?<!pattern)`

```javascript
var str = "wwww1wwwaa2waww3";
# 匹配非ww之后的数字，匹配结果为2
var pattern = /(?<!ww)\d+/;
```

## 贪婪与懒惰

- 贪婪模式：当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配 **尽可能多** 的字符
  - 一次性读入整个字符串进行匹配，每当不匹配就舍弃最右边一个字符，继续匹配，依次匹配和舍弃（这种匹配 - 舍弃的方式也叫做回溯），直到匹配成功或者把整个字符串舍弃完为止，因此它是一种最大化的数据返回，能多不会少

- 懒惰模式：当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配 **尽可能少** 的字符
  - 从左到右，从字符串的最左边开始匹配，每次试图不读入字符匹配，匹配成功，则完成匹配，否则读入一个字符再匹配，依此循环（读入字符、匹配）直到匹配成功或者把字符串的字符匹配完为止
- 未经修饰的量词就是贪心量词（`*`、`+`、`?`、`{}`），末尾加上 `?` 则使量词变懒惰

```javascript
var str = "string_123123123";

# 贪婪模式，匹配结果为：string__123123123123
var pattern = /string.?123/;

# 懒惰模式，匹配结果为：string__123
var pattern = /string.??123/;
```

## 更多

- [正则表达式真的很骚，可惜你不会写！！！](https://juejin.im/post/5b96a8e2e51d450e6a2de115)
- [这次不会说我的正则教程没写全了吧？？](https://juejin.im/post/5b9e7b6ce51d450e8a65ed6b)
- [正则表达式基础笔记](https://segmentfault.com/a/1190000004992869#articleHeader20)
- [learn-regex/translations/README-cn.md](https://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md)
- [正则表达式](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions)

- [JS正则表达式详解](https://www.cnblogs.com/moqiutao/p/6513628.html)
- [REGEXPER](https://regexper.com)
- [regexr](https://regexr.com/)









