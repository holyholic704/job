## 磁盘分区的配置

在目前的 Linux 环境下， 如果磁盘没有超过 2TB 的话，那么 Linux **默认是会以 MBR** 模式来处理分区表的。可以安装的时候加上某些参数， 强迫系统使用 GPT 的分区表来配置磁盘。而预计实际分区的情况如下：

| 所需目录  | 磁盘容量 |  文件空间  | 分区格式 |
| :-------: | :------: | :--------: | :------: |
| BIOS boot |   2MB    | 系统自定义 |  主分区  |
|   /boot   |   1GB    |    xfs     |  主分区  |
|     /     |   10GB   |    xfs     | LVM方式  |
|   /home   |   5GB    |    xfs     | LVM方式  |
|   swap    |   1GB    |    swap    | LVM方式  |



## 装置类型

- **标准分区区**：就是我们一直谈的分区槽，类似 /dev/vda1 之类的分区就是了。
- **LVM**：这是一种可以**弹性增加/削减**文件系统容量的装置设定。
- **LVM紧张供应**：是 LVM 的进阶版，与传统 LVM 直接分配固定的容量不同，  LVM 紧张供应可以让你在使用多少容量才分配磁盘多少容量给你，所以如果LVM 装置内的数据量较少，那么你的磁盘其实还可以作更多的资料储存，而不会被平白无故的占用。



## 文件系统

**就是实际格式化的时候，可以格式化成什么文件系统的意思**



+ **ext2/ext3/ext4**：Linux 早期适用的文件系统类型。由于 ext3/ext4 文件系统多了日志的记录， 对于系统的复原比较快速。不过由于磁盘容量越来越大，近来比较少使用 ext4 项目了。
+ **swap**：就是磁盘仿真成为内存，由于 swap 不会使用到目录树的挂载，所以用 swap 就不需要指定挂载点。
+ **BIOS boot**：就是 GPT 分区表可能会使用到的项目，若你使用 MBR 分区，那就不需要这个项目了。
+  **xfs**：这个是目前 CentOS 预设的文件系统，最早是由大型服务器所开发出来的。 他对于大容量的磁盘管理
    非常好，而且格式化的时候速度相当快，很适合当今动不动就是好几个 TB 的磁盘的环境，**非常常用。**
+  **vfat**：同时被 Linux 与 Windows 所支持的文件系统类型。如果主机硬盘内同时存在 Windows 与 Linux操作系统，为了数据的交换， 确实可以建置一个 vfat 的文件系统。



## KDUMP
这个项目主要在处理，当 Linux 系统因为核心问题导致的当机事件时，会将该当机事件的内存内数据储存出来的一项特色。若不需要，也能够关闭它，对系统的影响似乎并不太大。



## 指令基本格式

**`command [options] [arguments]`，command称为指令，options称为选项，arguments称为参数**

选项和参数都作为Shell命令执行时的输入，它们**之间用空格分隔开，空格的多少不影响指令的执行**。

- **Linux是区分大小写的**
- 如果指令太长可以输入**`\`**，之后**按回车**，使指令连续到下一行

**一般来说**，后面跟的选项如果**单字符**选项前使用**`-`**。**单词选项**前使用**`--`**

- 这是一般的情况，有些命令还是不归属这种规律的，相对较少。

- 例子：**`ls -a`**和**`ls -all`**，单个字符**`a` **使用**`-`**，一个单词**`all` **使用**`--`**

在Linux中，**可执行的文件**也进行了分类：

- **内置命令**：出于效率的考虑，将一些常用命令的解释程序**构造在Shell内部**。
- **外置命令**：存放在/bin、/sbin目录下的命令
- **实用程序**：存放在/usr/bin、/usr/sbin、/usr/share、/usr/local/bin等目录下的实用程序
- **用户程序**：用户程序经过编译生成可执行文件后，可作为Shell命令运行
- **Shell脚本**：由Shell语言编写的批处理文件，可作为Shell命令运行



## 常用快捷键

**`Tab`**：命令补全和文件补全（连按两下）

**`Ctrl` + `A`**：将光标移到行首

**`Ctrl` + `E`**：将光标移到行尾

**`Ctrl` + `C`**：中断目前程序

**`Ctrl` + `D`**：相当于离开（exit）

**`Ctrl` +` L`**：清空终端，相当于（clear）

**`Ctrl` +` Z`**：将正在运行的程序送到后台

**`Ctrl` +`U`**：删除当前光标到行首的命令

**`shift` +` Page UP` / `Page Down`**：上下翻页



## 指令

### 常用指令

+ **`date`**：显示日期
  +   **`date +%Y%m%d-%H%M%S`**：2019/04/12-15:32:59


+ **`cal`**：显示日历

  + **`cal`**：今天的日历

  * **`cal 2015`**：当年的日历
  * **`cal 07 1996`**：当年当月的日历

+ **`bc`**：简单好用的计算器

  + **`scale=n`**：n为小数点位数，bc预设只输出整数，如果要输出浮点数，必须执行该命令
  + **`+`**：加法
  + **`-`**：减法
  + **`*`**：乘法
  + **`/`**：除法
  + **`^`**：指数
  + **`%`**：取余
  + **`quit`**：退出


* **`nano`**：简单的文本编辑器
  * 界面包含按键提示



## 帮助

+ **`--help`**：指令的基本用法与选项介绍
+ **`man`**： manual 的缩写，将指令的具体信息（man page）显示出来
  + man page的数据默认存放在**`/usr/share/man`**目录里面
  + **`/String`**：在man page中向下搜寻字符串
  + **`？String`**：在man page中向上搜寻字符串
  + **`n`**：继续下一个搜寻
  + **`N`**：反向搜寻
  + **` q`**：结束搜寻
+ **`info`**：与 man 类似， info 会将文档分成一个个页面，每个页面可以进行跳转



#### 1. man page

**man page组成部分**

| 代号        | 内容说明                                                     |
| ----------- | ------------------------------------------------------------ |
| NAME        | 简短的指令、数据名称说明                                     |
| SYNOPSIS    | 简短的指令下达语法(syntax)简介                               |
| DESCRIPTION | 较为完整的说明，这部分最好仔细看看                           |
| OPTIONS     | 针对 SYNOPSIS 部分中，有列举的所有可用的选项说明             |
| COMMANDS    | 当这个程序(软件)在执行的时候，可以在此程序(软件)中下达的指令 |
| FILES       | 这个程序或数据所使用或参考或连结到的某些文件                 |
| SEE ALSO    | 可以参考的，跟这个指令或数据有相关的其他说明                 |
| EXAMPLE     | 一些可以参考的范例                                           |



**man page中第一行括号中数字的含义**

| 代号  | 代表内容                                                     |
| ----- | ------------------------------------------------------------ |
| **1** | **用户在 shell 环境中可以操作的指令或可执行文件**            |
| 2     | 系统核心可呼叫的函数与工具等                                 |
| 3     | 一些常用的函数(function)与函式库(library)，大部分为 C 的函式库(libc) |
| 4     | 装置文件的说明，通常在/dev 下的文件                          |
| **5** | **配置文件或者是某些文件的格式**                             |
| 6     | 游戏                                                         |
| 7     | 惯例与协议等，例如 Linux 文件系统、网络协议、ASCII code 等等的说明 |
| **8** | **系统管理员可用的管理指令**                                 |
| 9     | 跟 kernel 有关的文件                                         |



#### 2. info page

**info page组成部分**

| 代号 | 内容说明                                        |
| ---- | ----------------------------------------------- |
| File | 文件来源                                        |
| Node | 当前节点                                        |
| Next | 后一个节点                                      |
| Up   | 回到上一层的节点总揽画面，也可以按下U回到上一层 |
| Prev | 前一个节点                                      |



**3. 其他有用的文件**

更多的说明文件都存放在**`/usr/share/doc`**目录中



## 关机

* **`sync`**：synchronize的缩写，为了加快对磁盘文件的读写速度，位于内存中的文件数据不会立即同步到磁盘上，因此关机之前需要先进行 sync 同步操作，即使**`shutdown`/`reboot`/`halt`**等指令在关机前已经进行了sync的调用
  * 普通用户也可使用，普通用户只保存自己的数据，管理员可以保存整个系统的数据
* **`shutdown`**：关机，默认1分钟后关机，关机讯息会显示在登入者的屏幕上
  * 只有管理员有权限执行
  * **` shutdown -[h/r/k] [时间] '警告讯息'`**
    * 可以指定具体时间，如**`19:30`**
    * 指定多少分钟后关机，如**`10`**、**`+10`**（二者效果一样）
    * 立即关机，**`now`**
  * **` shutdown -h`**：将系统的服务停掉后，立即关机，常用
  * **` shutdown -r`**：将系统的服务停掉之后就重新启动，常用
  * **` shutdown -k`**：不进行关机，只发送警告讯息
  * **` shutdown -c`**：取消已经在进行的 shutdown 指令
* **`reboot`**：重启
* **`halt`**：系统停止，屏幕可能会保留系统已经停止的讯息，其实就是调用**` shutdown -h`**
* **`poweroff`**：系统关机，没有提供额外的电力，屏幕空白



## 文件与目录

### 一切皆文件

在Linux操作系统中，所有被操作系统管理的资源，例如网络接口卡、磁盘驱动器、打印机、输入输出设备、普通文件或是目录都被看作是一个文件。**也是Linux系统中一个重要的概念！**



### 文件属性

> **`drwxr-xr-x.   5   root   root   2046   May   29   16:08   .config`**
>
> **`-rw-------.   1   root   root    176   Apr    2   19:14   wlgq`**
>
> **`-rw-r--r--.   1   root   root     18   Dec   28    2013   .bashrc`**
>
> ①——————   ②      ③—       ④—        ⑤—      ⑥————————      ⑦———



#### ①：文件的类型与权限

![1555069133774](linux.assets/1555069133774.png)

* 第一组为**文件拥有者可具备的权限**（user）
* 第二组为**加入此群组之账号的权限**（group）
* 第三组为**非本人且没有加入本群组之其他账号的权限**（others）
* **超级用户root具有一切权限**



| 文件类型标识 |                           文件类型                           |
| :----------: | :----------------------------------------------------------: |
|    **-**     |                         **普通文件**                         |
|    **d**     |                           **目录**                           |
|    **l**     |           **链接文件**，类似Windows下面的快捷方式            |
|    **s**     | **套接字文件**，这类文件通常用在网络数据连接，可以启动一个程序来监听客户端的要求，客户端就可以通过套接字来进行数据通信 |
|    **b**     | **块设备文件**，存储数据以供系统存取的接口设备，简单而言就是硬盘 |
|    **c**     |      **字符设备**，串行端口的接口设备，如键盘、鼠标等等      |
|    **p**     | **管道文件（FIFO）**，是一种特殊的文件类型，Linux系统下，进程之间通信可以通过该文件完成 |



#### ②：表示有多少档名连结到此节点(i-node)

* 每个文件都会将他的权限与属性记录到文件系统的 i-node 中，不过，我们使用的目录树却是使用文件名来记录， 因此每个档名就会连结到一个 i-node 。这个属性记录的，就是有多少不同的档名连结到相同的一个 i-node 号码去就是了



#### ③：文件的拥有者账号

#### ④：文件所属的群组

#### ⑤：文件的容量大小

#### ⑥：最近的修改日期

#### ⑦：文件的档名

* 文件或者目录



### 改变文件属性与权限

* **`chgrp`**：change group的缩写，改变所属群组
  * **`chgrp [群组名] [文件]`**：改变所属群组
  * **`chgrp -R [群组名] [文件]`**：进行递归的持续变更，即同次目录下的所有文件、目录都更新成为这个群组。常常用在变更某一目录内所有的文件的情况。
* **`chown`**：change owner的缩写，改变文件拥有者
  * **`chown [账号名] [文件]`**：改变文件拥有者
  * **`chown [账号名:群组] [文件]`**：改变文件拥有者和所属群组
  * **`chown -R [账号名] [文件]`**：进行递归的持续变更
* **`chmod`**：change mode的缩写，改变权限
  * 数字类型改变文件权限
    * 如**`chomod 756 test`**：将test文件的权限**`-rwxrwxrwx`**修改为**`-rwxr-xrw-`**
    * 权限分数对照：**`r:4`**、**`w:2`**、**`x:1`**
  * 符号类型改变文件权限
    * 如**`chomod u=rwx,g-x,o+x test`**：将test文件的权限**`-rwxrwx---`**修改为**`-rwxrw---x`**
    * 权限身份对照：**`u:user`**、**`g:group`**、**`o:others`**、**`a:all`**
    * **`u/g/o`**可以连写，如**`u=rx,go-rwx`**、**`ugo=rwx`**
    * 运算符对照：**`+:加入权限`**、**`-:去除权限`**、**`=:设定权限`**
  * **`chomod [权限] [文件]`**：修改文件权限
  * **`chomod -R [权限] [文件]`**：进行递归的持续变更



### rwx

* **文件**
  * **r (read)**：可读取此文件的实际内容，如读取文本文件的文字内容等
  * **w (write)**：可以编辑、新增或者是修改该文件的内容（但不含删除该文件）
  * **x (execute)**：该文件具有可以被系统执行的权限
* **目录**
  * **r (read contents in directory)**：表示具有读取目录结构列表的权限
  * **w (modify contents of directory)**：表示具有异动该目录结构列表的权限
    * 建立新的文件与目录
    * 删除已经存在的文件与目录（不论该文件的权限为何）
    * 将已存在的文件或目录进行更名
    * 移动该目录内的文件或目录的位置
  * **x (access directory)**：目录的 x 代表的是用户能否进入该目录成为工作目录（work directory）就是你
    目前所在的目录
    * 能不能进入一个目录，只与x权限有关，即使具有该目录的r或w权限
  * 如果用户具有某个目录的rwx权限，没有里面某个文件的rwx权限，用户无法读写或执行该文件，但是可以删除该文件



### 文件的管理

* **`ls`**：list的缩写，文件的检视，默认按档名进行排序
  * 命令可以连写，如**`ls -al`**、**`ls -alFt`**
  * **`ls -a`**：全部的文件，连同隐藏档（开头为 . 的文件）一起列出来，常用
  * **`ls -A`**：全部的文件，连同隐藏档一起列出来，不包括**`.`**与**`..`**两个目录
  * **`ls -d`**：只列出目录本身，不列出目录内的文件数据，常用
  * **`ls -f`**：只列出结果，不进行排序
  * **`ls -F`**：根据文件、目录等信息，给予附加数据结构
  * **`ls -i`**：列出 inode 号码
  * **`ls -l`**：长数据串行出，包含文件的属性与权限等等数据，常用
  * **`ls -r`**：将排序结果反向输出
  * **`ls -R`**：连同子目录内容一起列出来，该目录下的所有文件都会显示出来
  * **`ls -S`**：按文件容量大小排序
  * **`ls -t`**：按时间排序
* **`cp`**：copy的缩写，复制文件
  - **`cp [来源文件] [目标文件]`**：复制来源文件到目标文件，同时复制执行者的属性和权限



### 目录结构



![6874](linux.assets/6874.png)



### 常见目录

- **/bin：** 存放二进制可执行文件(ls,cat,mkdir等)，常用命令一般都在这里
- **/etc：** 存放系统管理和配置文件
- **/home：** 存放所有用户文件的根目录，是用户主目录的基点，比如用户user的主目录就是/home/user，可以用~user表示
- **/usr ：** 用于存放系统应用程序
- **/opt：** 额外安装的可选应用程序包所放置的位置。一般情况下，我们可以把tomcat等都安装到这里
- **/proc： **虚拟文件系统目录，是系统内存的映射。可直接访问这个目录来获取系统信息
- **/root：** 超级用户（系统管理员）的主目录
- **/sbin：** 存放二进制可执行文件，只有root才能访问。这里存放的是系统管理员使用的系统级别的管理命令和程序
- **/dev：** 用于存放设备文件
- **/mnt：** 系统管理员安装临时文件系统的安装点，系统提供这个目录是让用户临时挂载其他的文件系统
- **/boot：** 存放用于系统引导时使用的各种文件
- **/lib ：** 存放着和系统运行相关的库文件 
- **/tmp：** 用于存放各种临时文件，是公用的临时文件存储点
- **/var：** 用于存放运行时需要改变数据的文件，也是某些大文件的溢出区，比方说各种服务的日志文件等
- **/lost+found：** 这个目录平时是空的，系统非正常关机而留下“无家可归”的文件就在这里



### 相对路径和绝对路径

* 绝对路径：由根目录**`/`**开始写起的文件名或目录名称， 如**` /home/test`**
* 相对路径：相对于目前路径的文件名写法，如 **` ./home/test`**或 **` ../../home/test`** 等等。开头不是**` /`**就属于相对路径的写法
  * **`.`**：代表当前的目录，也可以使用**`./`**来表示
  * **`..`**：代表上一层目录，也可以使用**`../`**来表示
  * **`-`**：代表前一层目录
  * **`~`**：代表当前用户的家目录
  * **`~[用户名]`**：代表用户的家目录



### 目录的相关操作

* **`cd`**：change directory的缩写，变换目录
* **`pwd`**：print working directory的缩写，显示目前所在的目录
* **`mkdir`**：make directory的缩写，建立新目录
  * **`mkdir -p [目录名称]`**：递归建立目录，如**`mkdir -p t1/t2/t3`**
  * **`mkdir -m [目录名称]`**：建立目录时配置文件的权限**`mkdir -m 770 test`**
* **`rmdir`**：remove directory的缩写，删除空目录
  * **`mkdir -p [目录名称]`**：连同上层的空目录一同删除



